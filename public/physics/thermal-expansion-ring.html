<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç†±æ¼²å†·ç¸®ï¼šç’°å½¢è†¨è„¹åŸç†æ¨¡æ“¬</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #1a1a1a;
            color: #eee;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0;
            padding: 20px;
            overflow: hidden;
        }

        h2 { margin-bottom: 10px; }
        p { color: #aaa; margin-bottom: 20px; text-align: center; max-width: 600px;}

        .controls {
            background: #2a2a2a;
            padding: 15px 30px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 20px;
            border: 1px solid #444;
        }

        input[type=range] {
            width: 250px;
            cursor: pointer;
        }

        .labels {
            display: flex;
            justify-content: space-between;
            width: 100%;
            font-size: 0.9em;
            color: #888;
        }

        canvas {
            background: #000;
            border-radius: 50%; /* è®“ç•«å¸ƒçœ‹èµ·ä¾†åƒå€‹åœ“å½¢è¦–çª— */
            box-shadow: inset 0 0 50px rgba(255,255,255,0.05), 0 0 20px rgba(0,0,0,0.8);
            border: 2px solid #333;
        }

        .stats {
            margin-top: 15px;
            font-family: monospace;
            font-size: 1.1em;
        }

        .highlight {
            color: #ff9d00;
            font-weight: bold;
        }
        
        /* è¼”åŠ©èªªæ˜çš„æ¨£å¼ */
        .legend {
            display: flex;
            gap: 20px;
            font-size: 0.85em;
            margin-top: 10px;
            color: #888;
        }
        .dot { width: 10px; height: 10px; display: inline-block; border-radius: 50%; margin-right: 5px; }
        .dot-ref { border: 1px dashed #666; background: transparent; }
        .dot-real { background: #4a90e2; }
    </style>
</head>
<body>

    <h2>ç†±æ¼²å†·ç¸®ï¼šç’°å½¢è†¨è„¹æ¨¡æ“¬</h2>
    <p>æ‹–å‹•æ»‘æ¡¿èª¿æ•´æº«åº¦ï¼Œè§€å¯Ÿç²’å­éœ‡å‹•èˆ‡ã€Œå…§åœˆåŠå¾‘ã€çš„è®ŠåŒ–ã€‚<br>è«‹æ³¨æ„ï¼šé›–ç„¶ç²’å­æƒ³å¾€å››é¢å…«æ–¹éœ‡å‹•ï¼Œä½†ç‚ºäº†ç¶­æŒé–“è·ï¼Œæ•´å€‹ç’°å¿…é ˆå‘å¤–æ“´å¼µã€‚</p>

    <div class="controls">
        <div>
            <div class="labels">
                <span>â„ï¸ å†· (ä½æº«)</span>
                <span>ğŸ”¥ ç†± (é«˜æº«)</span>
            </div>
            <input type="range" id="tempSlider" min="0" max="100" value="0">
        </div>
        <div style="text-align: left;">
            <div>ç›®å‰æº«åº¦: <span id="tempDisplay" class="highlight">0Â°C</span></div>
        </div>
    </div>

    <canvas id="simCanvas" width="500" height="500"></canvas>
    
    <div class="stats">
        å…§åœˆåŠå¾‘: <span id="innerRadiusDisplay">100.0</span> px 
        (<span id="statusText" style="color:#0f0">åŸºæº–ç‹€æ…‹</span>)
    </div>

    <div class="legend">
        <div><span class="dot dot-ref"></span>è™›ç·šåœˆï¼š0Â°C åŸå§‹å¤§å°</div>
        <div><span class="dot dot-real" style="background:linear-gradient(90deg, #4a90e2, #ff5e5e)"></span>ç²’å­é¡è‰²ï¼šéš¨æº«åº¦è®Šç´…</div>
    </div>

    <script>
        const canvas = document.getElementById('simCanvas');
        const ctx = canvas.getContext('2d');
        const slider = document.getElementById('tempSlider');
        const tempDisplay = document.getElementById('tempDisplay');
        const radiusDisplay = document.getElementById('innerRadiusDisplay');
        const statusText = document.getElementById('statusText');

        // è¨­å®šåƒæ•¸
        const centerX = canvas.width / 2;
        const centerY = canvas.height / 2;
        
        // ç’°çš„åƒæ•¸ (åŸºæº–å€¼)
        const baseInnerRadius = 80;
        const baseOuterRadius = 180;
        const rings = 8; // ç’°çš„å±¤æ•¸
        const particlesPerRingBase = 20; // æœ€å…§å±¤çš„ç²’å­æ•¸

        let particles = [];

        // åˆå§‹åŒ–ç²’å­
        function initParticles() {
            particles = [];
            // å»ºç«‹å¤šå±¤åŒå¿ƒåœ“çš„ç²’å­
            for (let r = 0; r < rings; r++) {
                // ç•¶å‰å±¤çš„åŠå¾‘ (0~1 ä¹‹é–“çš„æ¯”ä¾‹)
                const layerProgress = r / (rings - 1); 
                const currentBaseRadius = baseInnerRadius + (baseOuterRadius - baseInnerRadius) * layerProgress;
                
                // æ ¹æ“šåŠå¾‘æ±ºå®šé€™ä¸€åœˆæœ‰å¤šå°‘ç²’å­ (å¤–åœˆç²’å­æ¯”è¼ƒå¤šï¼Œç¶­æŒå¯†åº¦å‡å‹»)
                const count = Math.floor(particlesPerRingBase * (currentBaseRadius / baseInnerRadius));
                
                for (let i = 0; i < count; i++) {
                    const angle = (Math.PI * 2 * i) / count;
                    particles.push({
                        baseR: currentBaseRadius,   // åŸºæº–åŠå¾‘
                        angle: angle,               // åŸºæº–è§’åº¦
                        r: currentBaseRadius,       // ç•¶å‰åŠå¾‘ (å‹•æ…‹)
                        x: 0,                       // ç•¶å‰ X
                        y: 0                        // ç•¶å‰ Y
                    });
                }
            }
        }

        // ç¹ªè£½èˆ‡ç‰©ç†è¨ˆç®—å¾ªç’°
        function draw() {
            // 1. ç²å–ç›®å‰æº«åº¦åƒæ•¸
            const temp = parseInt(slider.value); // 0 ~ 100
            
            // ç‰©ç†åƒæ•¸å°æ‡‰
            // è†¨è„¹ä¿‚æ•¸ (Expansion): æº«åº¦è¶Šé«˜ï¼Œå¹³è¡¡ä½ç½®è¶Šå¾€å¤–æ¨
            const expansionFactor = 1 + (temp * 0.003); 
            
            // éœ‡å‹•å¹…åº¦ (Vibration): æº«åº¦è¶Šé«˜ï¼ŒæŠ–å‹•è¶Šå¤§
            const vibrationAmt = temp * 0.5;

            // æ›´æ–°ä»‹é¢æ•¸å€¼
            tempDisplay.textContent = temp + "Â°C";
            const currentInnerR = (baseInnerRadius * expansionFactor).toFixed(1);
            radiusDisplay.textContent = currentInnerR;
            
            if(temp === 0) {
                statusText.textContent = "åŸºæº–ç‹€æ…‹";
                statusText.style.color = "#4a90e2";
            } else {
                statusText.textContent = "è†¨è„¹ä¸­ (å…§å­”è®Šå¤§)";
                statusText.style.color = "#ff5e5e";
            }

            // 2. æ¸…ç©ºç•«å¸ƒ
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // 3. ç¹ªè£½åƒè€ƒç·š (åŸæœ¬å¤§å°çš„è™›ç·š)
            ctx.beginPath();
            ctx.strokeStyle = '#444';
            ctx.setLineDash([5, 5]);
            ctx.lineWidth = 1;
            ctx.arc(centerX, centerY, baseInnerRadius, 0, Math.PI * 2); // åŸå§‹å…§åœˆ
            ctx.stroke();
            ctx.beginPath();
            ctx.arc(centerX, centerY, baseOuterRadius, 0, Math.PI * 2); // åŸå§‹å¤–åœˆ
            ctx.stroke();
            ctx.setLineDash([]); // é‡ç½®è™›ç·š

            // 4. è¨ˆç®—ä¸¦ç¹ªè£½æ‰€æœ‰ç²’å­
            // æ ¹æ“šæº«åº¦æ”¹è®Šé¡è‰² (è— -> ç´…)
            const rCol = Math.min(255, 74 + temp * 1.8);
            const gCol = Math.min(255, 144 - temp * 0.5);
            const bCol = Math.min(255, 226 - temp * 1.5);
            ctx.fillStyle = `rgb(${rCol}, ${gCol}, ${bCol})`;

            particles.forEach(p => {
                // --- ç‰©ç†æ ¸å¿ƒ ---
                
                // A. ç†±è†¨è„¹æ•ˆæ‡‰ï¼š
                // æ¯å€‹ç²’å­çš„ã€Œå¹³è¡¡ä½ç½®ã€éƒ½é é›¢åœ“å¿ƒ
                // é€™å°±æ˜¯ç‚ºä»€éº¼å…§åœˆæœƒè®Šå¤§çš„åŸå› ï¼šæœ€å…§å±¤çš„ç²’å­å¹³è¡¡é»ä¹Ÿå¾€å¤–ç§»äº†
                let currentBaseR = p.baseR * expansionFactor;

                // B. ç†±éœ‡å‹•æ•ˆæ‡‰ï¼š
                // åœ¨å¹³è¡¡ä½ç½®é™„è¿‘éš¨æ©ŸæŠ–å‹•
                let jitterX = (Math.random() - 0.5) * vibrationAmt;
                let jitterY = (Math.random() - 0.5) * vibrationAmt;

                // è¨ˆç®—æœ€çµ‚ä½ç½®
                // x = (æ–°åŠå¾‘ * cosè§’åº¦) + éš¨æ©Ÿéœ‡å‹•
                p.x = centerX + Math.cos(p.angle) * currentBaseR + jitterX;
                p.y = centerY + Math.sin(p.angle) * currentBaseR + jitterY;

                // ç¹ªè£½ç²’å­
                ctx.beginPath();
                ctx.arc(p.x, p.y, 3 + temp * 0.02, 0, Math.PI * 2); // æº«åº¦é«˜æ™‚ç²’å­è¦–è¦ºä¸Šä¹Ÿç¨å¾®è†¨è„¹
                ctx.fill();
            });

            // 5. ç¹ªè£½ç•¶å‰çš„é‚Šç•Œåœ“ (è¦–è¦ºè¼”åŠ©ï¼Œè®“è®Šå¤§æ›´æ˜é¡¯)
            ctx.beginPath();
            ctx.strokeStyle = `rgba(${rCol}, ${gCol}, ${bCol}, 0.5)`;
            ctx.lineWidth = 2;
            // ç•«å‡ºç›®å‰çš„å…§åœˆé‚Šç•Œ (ç†è«–å€¼)
            ctx.arc(centerX, centerY, baseInnerRadius * expansionFactor, 0, Math.PI * 2);
            ctx.stroke();

            requestAnimationFrame(draw);
        }

        initParticles();
        draw();

    </script>
</body>
</html>