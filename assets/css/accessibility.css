/**
 * ç„¡éšœç¤™å°ˆç”¨æ¨£å¼
 * ç¬¦åˆ WCAG 2.2 AA æ¨™æº–
 * ç‰ˆæœ¬ï¼š1.0.0
 * æœ€å¾Œæ›´æ–°ï¼š2025-11-29
 */

/* ==================== è¢å¹•é–±è®€å™¨è¼”åŠ© ==================== */
.sr-only-focusable:not(:focus) {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

/* ç¢ºä¿ visually-hidden å…ƒç´ ä¸ä½”ç©ºé–“ */
.visually-hidden {
  position: absolute !important;
  width: 1px !important;
  height: 1px !important;
  padding: 0 !important;
  margin: -1px !important;
  overflow: hidden !important;
  clip: rect(0, 0, 0, 0) !important;
  white-space: nowrap !important;
  border: 0 !important;
}

/* ==================== Live Region æ¨£å¼ ==================== */
[aria-live] {
  min-height: 1.5em;
}

/* ç¢ºä¿ Live Region åœ¨è¦–è¦ºä¸Šä¸é¡¯ç¤ºä½†å° SR å¯è¦‹ */
[aria-live].visually-hidden {
  position: absolute !important;
}

/* ==================== æ¸›å°‘å‹•ç•«æ¨¡å¼æ”¯æ´ ==================== */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
  
  /* ä½†ä¿ç•™å¿…è¦çš„ç„¦é»æŒ‡ç¤ºå‹•ç•« */
  :focus-visible {
    transition: outline 0.15s ease !important;
  }
}

/* ==================== é«˜å°æ¯”åº¦æ¨¡å¼ ==================== */
@media (prefers-contrast: high) {
  :root {
    --site-focus-width: 4px;
  }
  
  .btn {
    border-width: 2px;
  }
  
  .card {
    border-width: 2px;
  }
  
  .form-control,
  .form-select {
    border-width: 2px;
  }
  
  /* ç¢ºä¿æ–‡å­—å°æ¯”åº¦ */
  body {
    background: #fff;
    color: #000;
  }
  
  [data-bs-theme="dark"] body {
    background: #000;
    color: #fff;
  }
}

/* ==================== å¼·åˆ¶é¡è‰²æ¨¡å¼ ==================== */
@media (forced-colors: active) {
  .skip-link:focus {
    forced-color-adjust: none;
    background: Canvas;
    color: CanvasText;
    outline: 2px solid Highlight;
  }
  
  :focus-visible {
    outline: 2px solid Highlight;
  }
}

/* ==================== éµç›¤å°èˆªå¢å¼· ==================== */
/* ç‚ºéµç›¤ä½¿ç”¨è€…é¡¯ç¤ºç„¦é»æŒ‡ç¤ºå™¨ */
.keyboard-focus:focus-visible {
  outline: 3px solid #ff9800;
  outline-offset: 2px;
}

/* Tab ç´¢å¼•ç‚º 0 çš„å¯äº’å‹•å…ƒç´  */
[tabindex="0"]:focus-visible {
  outline: 2px solid #0d6efd;
  outline-offset: 2px;
}

/* ==================== ARIA ç‹€æ…‹è¦–è¦ºåŒ–ï¼ˆé–‹ç™¼è¼”åŠ©ï¼‰ ==================== */
/* é–‹ç™¼æ¨¡å¼ä¸‹å¯å•Ÿç”¨ï¼Œç”Ÿç”¢ç’°å¢ƒæ‡‰ç§»é™¤ */
/*
[aria-hidden="true"] {
  opacity: 0.5;
  pointer-events: none;
}

[aria-disabled="true"] {
  opacity: 0.6;
  cursor: not-allowed;
}

[aria-pressed="true"] {
  background-color: rgba(13, 110, 253, 0.2);
}
*/

/* ==================== ç„¦é»é™·é˜±ï¼ˆModal/Dialogï¼‰ ==================== */
.modal-open {
  overflow: hidden;
}

.modal.show {
  overflow-x: hidden;
  overflow-y: auto;
}

/* ==================== è·³éé‡è¤‡å…§å®¹é€£çµ ==================== */
.skip-links {
  position: absolute;
  left: -9999px;
  z-index: 999;
}

.skip-links a:focus {
  position: fixed;
  top: 0;
  left: 0;
  background: #000;
  color: #fff;
  padding: 0.5rem 1rem;
  text-decoration: none;
  z-index: 999;
}

/* ==================== èªè¨€æ–¹å‘æ”¯æ´ ==================== */
[dir="rtl"] .skip-link {
  left: auto;
  right: -1000px;
}

[dir="rtl"] .skip-link:focus {
  left: auto;
  right: 0;
  border-radius: 0 0 0 4px;
}

/* ==================== è‰²ç›²å‹å–„æ¨¡å¼ï¼ˆé¸ç”¨ï¼‰ ==================== */
/* å¯åœ¨æœªä¾†åŠ å…¥è‰²ç›²æ¿¾é¡æ”¯æ´ */
.colorblind-safe .text-danger {
  color: #d73027 !important; /* ç´…è‰²å¢å¼· */
}

.colorblind-safe .text-success {
  color: #1a9850 !important; /* ç¶ è‰²å¢å¼· */
}

/* ==================== æ”¾å¤§æ–‡å­—æ”¯æ´ ==================== */
/* ç¢ºä¿ 200% ç¸®æ”¾æ™‚å…§å®¹ä¸æº¢å‡º */
@media (min-width: 1280px) {
  html {
    font-size: 16px;
  }
}

/* ==================== è§¸æ§ç›®æ¨™å¤§å° ==================== */
/* WCAG 2.2 æ–°å¢ï¼šç¢ºä¿è§¸æ§ç›®æ¨™è‡³å°‘ 24x24 CSS pixels */
@media (pointer: coarse) {
  .btn,
  .form-check-input,
  .form-range,
  a {
    min-width: 24px;
    min-height: 24px;
  }
  
  /* å°æŒ‰éˆ•å¢åŠ  padding ç¢ºä¿è§¸æ§å€åŸŸ */
  .btn-sm {
    padding: 0.5rem 0.75rem;
  }
}

/* ==================== å°æ¯”åº¦å¢å¼·å·¥å…·é¡åˆ¥ ==================== */
.high-contrast {
  border: 2px solid currentColor;
}

.high-contrast-text {
  color: #000;
  background: #fff;
  padding: 0.25rem 0.5rem;
}

[data-bs-theme="dark"] .high-contrast-text {
  color: #fff;
  background: #000;
}

/* ==================== æ¸¬è©¦æ¨¡å¼ï¼ˆé–‹ç™¼ç”¨ï¼‰ ==================== */
/* åœ¨é–‹ç™¼æ™‚åŠ å…¥ .a11y-test åˆ° body å¯è¦–è¦ºåŒ–ç„¡éšœç¤™å…ƒç´  */
.a11y-test [aria-label]::after,
.a11y-test [aria-labelledby]::after {
  content: "ğŸ“";
  margin-left: 4px;
  font-size: 0.75em;
}

.a11y-test [role]::before {
  content: "[" attr(role) "]";
  font-size: 0.7em;
  color: #666;
  margin-right: 4px;
}
