<!DOCTYPE html>
<html lang="zh-Hant" data-bs-theme="light">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>å‡¸é€é¡æˆåƒæ¨¡æ“¬</title>
    <meta name="description" content="æ‹–æ›³ç‰©è·è§€å¯Ÿå‡¸é€é¡æˆåƒçš„åƒè·èˆ‡æ”¾å¤§ç‡è®ŠåŒ–" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
    <style>
        .skip-link{position:absolute;left:-1000px;top:0;background:#000;color:#fff;padding:.5rem 1rem;z-index:1000;} .skip-link:focus{left:0;}
        :focus-visible{outline:3px solid #ff9800;outline-offset:2px;}
        body{font-family:'Inter','Noto Sans TC',sans-serif;}
        #lensCanvas{background:#fff;border:1px solid #ccc;border-radius:4px;touch-action:none;display:block;width:100%;}
        .data-box{background:#fff;border:1px solid #dee2e6;border-radius:.5rem;padding:.75rem;}
        .data-box span.value{font-weight:700;font-size:1.05rem;display:block;margin-top:.25rem;}
        .live-region{min-height:1.2em;}
    </style>
</head>
<body class="d-flex flex-column min-vh-100">
    <a href="#main" class="skip-link">è·³åˆ°ä¸»å…§å®¹</a>
    <header>
        <nav class="navbar navbar-expand-lg bg-body-tertiary" aria-label="é é¢å°è¦½">
            <div class="container-fluid">
                <a class="navbar-brand" href="../index.html" aria-label="è¿”å›é¦–é "><i class="fa-solid fa-arrow-left" aria-hidden="true"></i> é¦–é </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navContent" aria-controls="navContent" aria-expanded="false" aria-label="åˆ‡æ›å°è¦½"><span class="navbar-toggler-icon"></span></button>
                <div class="collapse navbar-collapse" id="navContent">
                    <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                        <li class="nav-item"><a class="nav-link" href="../index.html#physics">ç‰©ç†</a></li>
                        <li class="nav-item"><a class="nav-link" href="../index.html#math">æ•¸å­¸</a></li>
                        <li class="nav-item"><a class="nav-link" href="../index.html#chemistry">åŒ–å­¸</a></li>
                    </ul>
                    <button id="themeToggle" class="btn btn-outline-secondary" type="button" aria-pressed="false" aria-label="åˆ‡æ›æ·±æ·ºä¸»é¡Œ"><i class="fa-solid fa-circle-half-stroke" aria-hidden="true"></i></button>
                </div>
            </div>
        </nav>
    </header>
    <main id="main" class="container py-3" tabindex="-1">
        <h1 class="h3 mb-2">å‡¸é€é¡æˆåƒåŸç†æ¨¡æ“¬</h1>
        <p class="mb-3">æ‹–æ›³ä¸‹æ–¹çš„ã€Œç‰©è·ã€æ‹‰æ¡¿æ”¹è®Šç‰©é«”ä½ç½® (p)ï¼Œè§€å¯Ÿåƒè· (i)ã€æ”¾å¤§ç‡ (M) èˆ‡æˆåƒæ€§è³ªçš„è®ŠåŒ–ã€‚ç„¦è·ä»¥ f ç‚ºå–®ä½é¡¯ç¤ºã€‚</p>
        <div class="row g-4">
            <section class="col-12 col-xl-8" aria-labelledby="sec-visual">
                <h2 id="sec-visual" class="visually-hidden">è¦–è¦ºå€</h2>
                <canvas id="lensCanvas" aria-label="å‡¸é€é¡æˆåƒæ¨¡æ“¬ç•«å¸ƒ" role="img"></canvas>
                <div id="lensStatus" class="live-region small mt-2" aria-live="polite" aria-atomic="true">ç‹€æ…‹ï¼šè¼‰å…¥ä¸­</div>
                <div class="card mt-3">
                    <div class="card-body small">
                        <strong>æç¤ºï¼š</strong> ç•¶ç‰©é«”ä½æ–¼ç„¦è·å…§ (p &lt; f) å½¢æˆæ­£ç«‹æ”¾å¤§çš„è™›åƒï¼›ä½æ–¼ç„¦è·å¤– (p &gt; f) å½¢æˆå€’ç«‹çš„å¯¦åƒï¼›ä½æ–¼ 2f æ™‚åƒèˆ‡ç‰©å¤§å°ç›¸ç­‰ï¼›ä½æ–¼ f ä¸Šä¸æˆåƒï¼ˆå¹³è¡Œå…‰ï¼‰ã€‚
                    </div>
                </div>
            </section>
            <aside class="col-12 col-xl-4" aria-labelledby="sec-controls">
                <h2 id="sec-controls" class="h5">æ§åˆ¶èˆ‡æ•¸æ“š</h2>
                <form class="mb-3" aria-describedby="sliderHelp">
                    <label for="positionSlider" class="form-label">ç‰©è·èª¿æ•´ (pï¼Œç›¸å°é€é¡)</label>
                    <input type="range" id="positionSlider" class="form-range" aria-valuemin="-999" aria-valuemax="999" aria-valuenow="0" aria-label="ç‰©è·æ‹‰æ¡¿">
                    <div id="sliderHelp" class="form-text">å‘å·¦ä»£è¡¨ç‰©é«”é é›¢é€é¡ï¼Œå‘å³ä»£è¡¨é è¿‘ã€‚</div>
                </form>
                <div class="row g-3" aria-label="å³æ™‚æ•¸æ“š">
                    <div class="col-6 col-md-6 data-box text-center" tabindex="0">
                        <span class="text-secondary small">ç‰©è· (p)</span>
                        <span id="objectDistance" class="value text-danger" aria-label="ç‰©è· f å€æ•¸">...</span>
                    </div>
                    <div class="col-6 col-md-6 data-box text-center" tabindex="0">
                        <span class="text-secondary small">åƒè· (i)</span>
                        <span id="imageDistance" class="value text-primary" aria-label="åƒè· f å€æ•¸">...</span>
                    </div>
                    <div class="col-6 col-md-6 data-box text-center" tabindex="0">
                        <span class="text-secondary small">æ”¾å¤§ç‡ (M)</span>
                        <span id="magnification" class="value" aria-label="æ”¾å¤§ç‡">...</span>
                    </div>
                        <div class="col-6 col-md-6 data-box text-center" tabindex="0">
                        <span class="text-secondary small">æˆåƒæ€§è³ª</span>
                        <span id="imageProperties" class="value" aria-label="æˆåƒæ€§è³ª">...</span>
                    </div>
                </div>
                <div class="btn-group mt-3" role="group" aria-label="è¼”åŠ©æ§åˆ¶">
                    <button type="button" id="btnReset" class="btn btn-outline-secondary" aria-label="é‡ç½®ç‰©è·">é‡ç½®</button>
                    <button type="button" class="btn btn-outline-info" data-bs-toggle="collapse" data-bs-target="#help" aria-expanded="false" aria-controls="help"><i class="fa-solid fa-circle-question" aria-hidden="true"></i> èªªæ˜</button>
                </div>
                <div id="help" class="collapse mt-2">
                    <div class="card card-body small">
                        <strong>å¿«æ·éµï¼š</strong>
                        <ul class="mb-2">
                            <li><kbd>â† / â†’</kbd>ï¼šå¾®èª¿ç‰©è·</li>
                            <li><kbd>R</kbd>ï¼šé‡ç½®</li>
                        </ul>
                        <p class="mb-0">å…¬å¼ï¼š<span aria-hidden="true">1/f = 1/p + 1/i</span><span class="visually-hidden">ä¸€é™¤ä»¥ç„¦è·ç­‰æ–¼ä¸€é™¤ä»¥ç‰©è·åŠ ä¸Šä¸€é™¤ä»¥åƒè·</span>ï¼›æ”¾å¤§ç‡ M = - i / pã€‚</p>
                    </div>
                </div>
            </aside>
        </div>
    </main>
    <footer class="mt-auto py-3 bg-light border-top small text-center" role="contentinfo">&copy; 2025 åœ‹ä¸­æ•¸ç†äº’å‹•å­¸ç¿’ç«™</footer>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // ä¸»é¡Œåˆ‡æ›
        const themeToggle = document.getElementById('themeToggle');
        function setTheme(t){document.documentElement.setAttribute('data-bs-theme',t);localStorage.setItem('theme',t);themeToggle.setAttribute('aria-pressed',t==='dark');}
        const storedTheme = localStorage.getItem('theme');
        if(storedTheme){setTheme(storedTheme);} else if(window.matchMedia('(prefers-color-scheme: dark)').matches){setTheme('dark');}
        themeToggle.addEventListener('click',()=>{const c=document.documentElement.getAttribute('data-bs-theme')||'light';setTheme(c==='light'?'dark':'light');});
    </script>
    <script>
        // åŸå§‹æ¨¡æ“¬ç¨‹å¼ç¢¼æ•´åˆ (ä¿ç•™é‚è¼¯ï¼Œèª¿æ•´é¸æ“‡å™¨èˆ‡èªæ„)
        const canvas = document.getElementById('lensCanvas');
        const ctx = canvas.getContext('2d');
        const objDistEl = document.getElementById('objectDistance');
        const imgDistEl = document.getElementById('imageDistance');
        const magEl = document.getElementById('magnification');
        const propsEl = document.getElementById('imageProperties');
        const slider = document.getElementById('positionSlider');
        const statusRegion = document.getElementById('lensStatus');
        const btnReset = document.getElementById('btnReset');

        let focalLength = 100; // åˆå§‹ç„¦è· (æœƒåœ¨ resize ä¸­èª¿æ•´)
        let objectHeight = 60; // ç‰©é«”é«˜åº¦
        let objectX = -250;    // ç‰©é«”ç›¸å°é€é¡ä¸­å¿ƒçš„ä½ç½® (è² å€¼åœ¨å·¦å´)
        let lensX;             // é€é¡ä¸­å¿ƒ X
        let axisY;             // ä¸»è»¸ Y

        function resizeCanvas(){
            canvas.width = canvas.clientWidth;
            canvas.height = canvas.width < 640 ? 300 : 400;
            focalLength = canvas.width / 7;
            objectHeight = focalLength * 0.6;
            lensX = canvas.width / 2;
            axisY = canvas.height / 2;
            const minX = -3.5 * focalLength;
            const maxX = -5;
            slider.min = minX; slider.max = maxX; slider.step = 1;
            if(objectX < minX || objectX > maxX){ objectX = -2.5 * focalLength; }
            slider.value = objectX;
            slider.setAttribute('aria-valuemin', minX.toFixed(0));
            slider.setAttribute('aria-valuemax', maxX.toFixed(0));
            slider.setAttribute('aria-valuenow', objectX.toFixed(0));
            drawScene();
        }

        function drawAxis(){
            ctx.save();
            ctx.beginPath();ctx.moveTo(0,axisY);ctx.lineTo(canvas.width,axisY);ctx.strokeStyle='#333';ctx.lineWidth=2;ctx.stroke();
            ctx.font='14px Inter';ctx.fillStyle='#555';ctx.textAlign='center';ctx.textBaseline='top';
            const labels=[-3,-2,-1,1,2,3];
            for(const m of labels){
                const x=lensX + m*focalLength;ctx.beginPath();ctx.moveTo(x,axisY-8);ctx.lineTo(x,axisY+8);ctx.strokeStyle='#888';ctx.lineWidth=1;ctx.stroke();
                let labelText = Math.abs(m)+'f'; if(m===1||m===-1) labelText='f'; ctx.fillText(labelText,x,axisY+12);
            }
            ctx.restore();
        }
        function drawLens(){
            ctx.save();
            const lensHeight = axisY*1.8; const lensTopY=axisY - lensHeight/2; const lensBottomY=axisY + lensHeight/2; const lensWidth=focalLength*0.2;
            ctx.beginPath();ctx.moveTo(lensX,lensTopY);ctx.quadraticCurveTo(lensX+lensWidth,axisY,lensX,lensBottomY);ctx.quadraticCurveTo(lensX-lensWidth,axisY,lensX,lensTopY);
            ctx.fillStyle='rgba(173,216,230,0.5)';ctx.strokeStyle='#007bff';ctx.lineWidth=2;ctx.fill();ctx.stroke();ctx.restore();
        }
        function drawCandle(x,y,height,color){
            ctx.save();
            const bodyHeight = height*0.75; const flameHeight = height*0.25; const candleWidth=Math.max(8,focalLength*0.12);
            ctx.fillStyle=color; ctx.fillRect(x - candleWidth/2, y, candleWidth, -bodyHeight);
            const wickY=y - bodyHeight; const wickTopY = wickY - flameHeight*0.2; ctx.strokeStyle='black'; ctx.lineWidth=Math.max(1,candleWidth*0.15);
            ctx.beginPath(); ctx.moveTo(x,wickY); ctx.lineTo(x,wickTopY); ctx.stroke();
            const flameBaseY=wickTopY; const flameTipY=y - height; const flameWidth=candleWidth*0.8;
            ctx.fillStyle='orange'; ctx.beginPath(); ctx.moveTo(x,flameBaseY); ctx.quadraticCurveTo(x - flameWidth,(flameBaseY+flameTipY)/2,x,flameTipY); ctx.quadraticCurveTo(x + flameWidth,(flameBaseY+flameTipY)/2,x,flameBaseY); ctx.fill();
            const innerFlameTipY = flameTipY + flameHeight*0.2; ctx.fillStyle='yellow'; ctx.beginPath(); ctx.moveTo(x,flameBaseY); ctx.quadraticCurveTo(x - flameWidth*0.5,(flameBaseY+innerFlameTipY)/2,x,innerFlameTipY); ctx.quadraticCurveTo(x + flameWidth*0.5,(flameBaseY+innerFlameTipY)/2,x,flameBaseY); ctx.fill();
            ctx.restore();
        }
        function drawObserver(){
            ctx.save(); const eyeSize=Math.max(24,focalLength*0.3); const x=canvas.width - eyeSize*0.7; const y=axisY; ctx.font=eyeSize+'px sans-serif'; ctx.textAlign='center'; ctx.textBaseline='middle'; ctx.fillText('ğŸ‘ï¸',x,y); ctx.restore();
        }
        function drawRays(p,i,imgHeight){
            ctx.save(); ctx.lineWidth=1;
            const objectTopX = lensX - p; const objectTopY = axisY - objectHeight; const imageTopX = lensX + i; const imageTopY = axisY - imgHeight;
            // Ray 1
            ctx.beginPath(); ctx.strokeStyle='rgba(255,100,0,0.7)'; ctx.moveTo(objectTopX,objectTopY); ctx.lineTo(lensX,objectTopY);
            if(p < focalLength){ ctx.lineTo(imageTopX,imageTopY); ctx.beginPath(); ctx.setLineDash([4,4]); ctx.moveTo(imageTopX,imageTopY); ctx.lineTo(lensX,objectTopY); ctx.stroke(); ctx.setLineDash([]);} else { ctx.lineTo(imageTopX,imageTopY); ctx.stroke(); }
            // Ray 2
            ctx.beginPath(); ctx.strokeStyle='rgba(0,150,0,0.7)'; ctx.moveTo(objectTopX,objectTopY);
            if(p < focalLength){ ctx.lineTo(imageTopX + (imageTopX - objectTopX), imageTopY + (imageTopY - objectTopY)); ctx.beginPath(); ctx.setLineDash([4,4]); ctx.moveTo(imageTopX,imageTopY); ctx.lineTo(objectTopX,objectTopY); ctx.stroke(); ctx.setLineDash([]);} else { ctx.lineTo(imageTopX,imageTopY); ctx.stroke(); }
            // Ray 3
            if(Math.abs(p - focalLength) > 1){ ctx.beginPath(); ctx.strokeStyle='rgba(150,0,200,0.7)'; const yAtLens = axisY - (objectHeight * focalLength / (p - focalLength)); ctx.moveTo(objectTopX,objectTopY); ctx.lineTo(lensX,yAtLens); if(p < focalLength){ ctx.lineTo(canvas.width,yAtLens); ctx.beginPath(); ctx.setLineDash([4,4]); ctx.moveTo(imageTopX,imageTopY); ctx.lineTo(lensX,yAtLens); ctx.stroke(); ctx.setLineDash([]);} else { ctx.lineTo(imageTopX,imageTopY); ctx.stroke(); }}
            ctx.restore();
        }
        function updateInfo(p,i,m,props){ objDistEl.textContent=(p/focalLength).toFixed(2)+' f'; if(i===Infinity){ imgDistEl.textContent='âˆ'; magEl.textContent='âˆ'; } else { imgDistEl.textContent=(i/focalLength).toFixed(2)+' f'; magEl.textContent=m.toFixed(2); } propsEl.textContent=props; }
        function drawScene(){
            ctx.clearRect(0,0,canvas.width,canvas.height); drawAxis(); drawLens(); drawObserver();
            const p = lensX - (lensX + objectX); let i,imgHeight,magnification; let properties='';
            const fontSize = canvas.width < 640 ? 14 : 16; const fontWeight='bold'; ctx.font=fontWeight+' '+fontSize+'px Inter';
            if(Math.abs(p - focalLength) < 1.5){ i=Infinity; imgHeight=Infinity; magnification=Infinity; properties='ä¸æˆåƒ (å¹³è¡Œå…‰)'; ctx.save(); ctx.lineWidth=1; ctx.strokeStyle='rgba(255,100,0,0.7)'; ctx.beginPath(); ctx.moveTo(lensX - p, axisY - objectHeight); ctx.lineTo(lensX, axisY - objectHeight); ctx.lineTo(canvas.width, axisY - objectHeight); ctx.stroke(); ctx.restore(); }
            else if(p < focalLength){ i=(focalLength * p)/(p - focalLength); magnification = -i/p; imgHeight = magnification * objectHeight; properties='è™›åƒã€æ­£ç«‹ã€æ”¾å¤§'; drawCandle(lensX + i, axisY, imgHeight, 'rgba(0,150,255,0.6)'); ctx.save(); ctx.fillStyle='rgba(0,150,255,0.8)'; ctx.textAlign='center'; ctx.textBaseline='bottom'; ctx.fillText('æ­£ç«‹è™›åƒ', lensX + i, axisY - imgHeight - 10); ctx.restore(); drawRays(p,i,imgHeight); }
            else { i=(focalLength * p)/(p - focalLength); magnification = -i/p; imgHeight = magnification * objectHeight; properties='å¯¦åƒã€å€’ç«‹,'; const tol=0.02; if(Math.abs(magnification) > 1+tol) properties+='æ”¾å¤§'; else if(Math.abs(magnification) < 1-tol) properties+='ç¸®å°'; else properties+='ç­‰å¤§'; drawCandle(lensX + i, axisY, imgHeight, '#0096FF'); ctx.save(); ctx.fillStyle='#007bff'; ctx.textAlign='center'; ctx.textBaseline='top'; ctx.fillText('å€’ç«‹å¯¦åƒ', lensX + i, axisY - imgHeight + 10); ctx.restore(); const isAt2f = Math.abs(magnification) >= (1 - tol) && Math.abs(magnification) <= (1 + tol); if(isAt2f){ ctx.save(); ctx.fillStyle='#D32F2F'; ctx.textAlign='center'; ctx.textBaseline='bottom'; ctx.fillText('å¤§å°ç›¸ç­‰', lensX + objectX, axisY - objectHeight - 10); ctx.textBaseline='top'; ctx.fillText('å¤§å°ç›¸ç­‰', lensX + i, axisY - imgHeight + fontSize + 14); ctx.restore(); } drawRays(p,i,imgHeight); }
            drawCandle(lensX + objectX, axisY, objectHeight, '#F87171'); updateInfo(p,i,magnification,properties); statusRegion.textContent='ç‹€æ…‹ï¼šç‰©è·èª¿æ•´ä¸­';
        }
        function onSliderMove(e){ objectX = parseFloat(e.target.value); slider.setAttribute('aria-valuenow', objectX.toFixed(0)); requestAnimationFrame(drawScene); }
        function reset(){ objectX = -2.5 * focalLength; slider.value = objectX; slider.setAttribute('aria-valuenow', objectX.toFixed(0)); drawScene(); statusRegion.textContent='ç‹€æ…‹ï¼šå·²é‡ç½®'; }
        window.addEventListener('resize', resizeCanvas);
        slider.addEventListener('input', onSliderMove);
        document.addEventListener('keydown', (e)=>{ if(e.key==='ArrowLeft'){ slider.stepDown(); slider.dispatchEvent(new Event('input')); } if(e.key==='ArrowRight'){ slider.stepUp(); slider.dispatchEvent(new Event('input')); } if(e.key==='r' || e.key==='R'){ reset(); } });
        btnReset.addEventListener('click', reset);
        document.fonts && document.fonts.load('1em Inter').then(()=>{ resizeCanvas(); statusRegion.textContent='ç‹€æ…‹ï¼šå°±ç·’'; });
    </script>


</body>
</html>